# 合同审查小助手 - 用户安装指南

## 📥 系统要求

- **操作系统**: Windows 7/8/10/11 (32位或64位)
- **内存**: 至少 2GB RAM（推荐 8GB+）
- **硬盘**: 至少 500MB 可用空间
- **网络**: 需要网络连接（使用云端AI时）

## 🚀 快速安装

### 方式一：单文件版本（最简单）

1. **下载程序**
   - 下载 `合同审查小助手.exe`
   - 文件大小：约 150-200MB

2. **直接运行**
   - 双击 `合同审查小助手.exe`
   - 首次运行会自动创建配置文件

3. **完成！**
   - 程序已就绪，开始使用

### 方式二：安装程序版本

1. **运行安装程序**
   - 双击 `合同审查小助手_安装程序.exe`
   - 按照安装向导操作

2. **选择安装位置**
   - 默认：`C:\Program Files\合同审查小助手`
   - 或选择自定义位置

3. **完成安装**
   - 桌面会创建快捷方式
   - 开始菜单添加程序项

### 方式三：便携版

1. **解压缩**
   - 解压 `合同审查小助手_便携版.zip`

2. **运行程序**
   - 双击 `合同审查小助手.exe`
   - 或双击 `启动助手.bat`

3. **可复制到U盘**
   - 整个文件夹可复制到U盘使用
   - 无需安装，随插随用

## ⚙️ 首次配置

### 1. 选择AI模型

启动程序后，需要配置AI模型：

#### 选项A：本地模型（推荐，隐私保护）

1. **安装Ollama**
   - 访问：https://ollama.ai
   - 下载并安装Ollama

2. **下载模型**
   ```bash
   ollama pull qwen2.5:7b
   ```

3. **在程序中配置**
   - 点击 "配置本地模型"
   - 确认Ollama服务地址
   - 选择使用的模型

#### 选项B：云端模型（快速，需API密钥）

1. **获取API密钥**
   - 访问：https://platform.deepseek.com/
   - 注册账号
   - 获取API密钥

2. **在程序中配置**
   - 点击 "配置DeepSeek API"
   - 输入API密钥
   - 保存配置

### 2. 测试连接

配置完成后：
- 点击 "测试连接" 按钮
- 确认AI模型工作正常
- 如有问题，查看错误提示

## 📖 使用指南

### 基本使用流程

1. **启动程序**
   - 双击桌面图标或程序文件

2. **选择版本**
   - **简洁版**: 适合快速审查单个合同
   - **专业版**: 适合批量审查和深度分析

3. **上传合同**
   - 点击 "合同上传" 按钮
   - 或直接拖放文件到程序窗口
   - 支持：.docx、.doc、.pdf 格式

4. **配置审查参数**
   - 选择身份（甲方/乙方）
   - 输入合同类型
   - 设置关注点

5. **开始审查**
   - 点击 "开始审查"
   - 等待AI分析
   - 查看审查意见

6. **导出报告**
   - 点击 "导出报告"
   - 自动生成Word文档
   - 保存到本地

### 高级功能

#### 批量审查
- 在专业版中上传多个合同
- 自动排队处理
- 历史记录管理

#### AI对话
- 在审查过程中与AI律师对话
- 补充审查特定条款
- 获取法律建议

#### 历史记录
- 查看所有审查记录
- 搜索历史记录
- 重新查看报告

## 🔧 常见问题

### Q1: 程序无法启动

**解决方法：**
1. 确认Windows版本（需要Win7+）
2. 右键选择"以管理员身份运行"
3. 临时关闭杀毒软件
4. 检查是否有防火墙提示

### Q2: 提示缺少DLL文件

**解决方法：**
1. 安装 [Visual C++ Redistributable](https://aka.ms/vs/17/release/vc_redist.x64.exe)
2. 重启电脑
3. 重新运行程序

### Q3: AI审查失败

**解决方法：**
1. **本地模型**：
   - 确认Ollama正在运行
   - 检查模型是否已下载
   - 查看Ollama日志

2. **云端模型**：
   - 检查网络连接
   - 确认API密钥有效
   - 检查API余额

### Q4: 文件解析失败

**解决方法：**
1. 确认文件格式（支持.docx、.doc、.pdf）
2. 文件可能损坏，尝试重新保存
3. PDF文件需要是文本格式，不能是扫描件

### Q5: 程序运行缓慢

**优化建议：**
1. **本地模型**：增加电脑内存
2. **云端模型**：检查网络速度
3. 关闭其他占用资源的程序
4. 使用较小的AI模型

### Q6: 杀毒软件报毒

**说明：**
- 这是误报，程序是安全的
- 添加到杀毒软件白名单：
  - Windows Defender：设置 → 病毒和威胁防护 → 排除项
  - 其他杀毒软件：参考各自文档

## 📂 配置文件位置

程序配置保存在：
```
C:\Users\<用户名>\.合同审查助手\
├── .env                # 主配置文件
├── cache/              # 缓存文件
│   ├── review_history.json  # 历史记录
│   └── app.log         # 日志文件
└── output/             # 输出报告
```

**手动编辑配置：**
1. 找到 `.env` 文件
2. 使用记事本打开
3. 修改配置项
4. 保存并重启程序

## 🔄 更新程序

### 检查更新
- 程序会自动检查更新（如果启用）
- 或访问下载页面查看新版本

### 更新步骤
1. 下载新版本程序
2. **便携版**：直接覆盖旧文件
3. **安装版**：
   - 先卸载旧版本
   - 安装新版本
   - 配置文件会保留

## 💡 使用技巧

### 1. 提高审查质量
- 关注点填写越具体，审查越精准
- 例如："付款周期、违约责任、知识产权归属"

### 2. 快速处理多个合同
- 使用专业版的批量上传功能
- 一次性选择多个文件
- 自动排队处理

### 3. 保存重要审查
- 定期检查历史记录
- 导出重要报告
- 备份 `cache` 文件夹

### 4. 优化AI性能
- **本地模型**：使用合适的模型大小
  - 快速：qwen2.5:3b
  - 平衡：qwen2.5:7b
  - 精准：qwen2.5:14b
- **云端模型**：注意API使用量

## 📞 获取帮助

### 内置帮助
- 程序内点击 "❓ 使用帮助" 按钮
- 查看详细的使用指南

### 日志文件
- 位置：`cache\app.log`
- 包含详细的错误信息
- 报告问题时请附上日志

### 技术支持
- 查看项目文档
- 提交问题反馈
- 参考社区讨论

## 📋 许可协议

本软件的使用受相应的许可证条款约束。

---

**祝您使用愉快！**

如有任何问题，请随时查阅帮助文档或联系技术支持。
